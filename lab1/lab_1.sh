#!/bin/bash

# Функция для вывода меню
show_menu() {
    echo "Меню:"
    echo "1. Текущий рабочий каталог"
    echo "2. Текущий запущенный процесс"
    echo "3. Домашний каталог"
    echo "4. Название и версия операционной системы"
    echo "5. Показать все доступные оболочки в вашей системе"
    echo "6. Текущие пользователи, вошедшие в систему"
    echo "7. Количество пользователей, вошедших в систему"
    echo "8. Информация о жестких дисках"
    echo "9. Информация о процессоре"
    echo "10. Информация о памяти"
    echo "11. Информация о файловой системе"
    echo "12. Информация об установленных пакетах ПО"
    echo "13. Выход"
}

# Функция для вывода всей информации в файл
output_to_file() {
    filename=$1
    echo "========================================" > $filename
    echo "Текущий рабочий каталог:" >> $filename
    pwd >> $filename
    echo "========================================" >> $filename
    echo "Текущий запущенный процесс:" >> $filename
    ps >> $filename
    echo "========================================" >> $filename
    echo "Домашний каталог:" >> $filename
    echo $HOME >> $filename
    echo "========================================" >> $filename
    echo "Название и версия операционной системы:" >> $filename
    lsb_release -a >> $filename
    echo "========================================" >> $filename
    echo "Доступные оболочки в системе:" >> $filename
    cat /etc/shells >> $filename
    echo "========================================" >> $filename
    echo "Текущие пользователи, вошедшие в систему:" >> $filename
    who >> $filename
    echo "========================================" >> $filename
    echo "Количество пользователей, вошедших в систему:" >> $filename
    who | wc -l >> $filename
    echo "========================================" >> $filename
    echo "Информация о жестких дисках:" >> $filename
    df -h >> $filename
    echo "========================================" >> $filename
    echo "Информация о процессоре:" >> $filename
    lscpu >> $filename
    echo "========================================" >> $filename
    echo "Информация о памяти:" >> $filename
    free -h >> $filename
    echo "========================================" >> $filename
    echo "Информация о файловой системе:" >> $filename
    df -T >> $filename
    echo "========================================" >> $filename
    echo "Информация об установленных пакетах ПО:" >> $filename
    dpkg -l >> $filename
    echo "========================================" >> $filename
}

# Проверка аргументов командной строки
if [[ "$1" == "--tofile" ]]; then
    output_to_file $2
    exit 0
fi

# Основной цикл программы
while true; do
    show_menu
    read -p "Выберите пункт меню: " -e choice
    case $choice in
        1) echo "Текущий рабочий каталог: $(pwd)";;
        2) echo "Текущий запущенный процесс:"; ps;;
        3) echo "Домашний каталог: $HOME";;
        4) echo "Название и версия операционной системы:"; lsb_release -a;;
        5) echo "Доступные оболочки в системе:"; cat /etc/shells;;
        6) echo "Текущие пользователи, вошедшие в систему:"; who;;
        7) echo "Количество пользователей, вошедших в систему: $(who | wc -l)";;
        8) echo "Информация о жестких дисках:"; df -h;;
        9) echo "Информация о процессоре:"; lscpu;;
        10) echo "Информация о памяти:"; free -h;;
        11) echo "Информация о файловой системе:"; df -T;;
        12) echo "Информация об установленных пакетах ПО:"; dpkg -l;;
        13) break;;
        *) echo "Неверный выбор. Попробуйте снова.";;
    esac
    read -p "Для продолжения нажмите Enter"
done
